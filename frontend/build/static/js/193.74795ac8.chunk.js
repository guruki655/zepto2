"use strict";(self.webpackChunkzepto2=self.webpackChunkzepto2||[]).push([[193],{4193:(e,t,r)=>{r.r(t),r.d(t,{default:()=>S});var s,n=r(5043),a=r(4432),i=r(8231),o=r(6213),c="basil",d="https://js.stripe.com",l="".concat(d,"/").concat(c,"/stripe.js"),u=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,p=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,m="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",h=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(l).concat(t);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},f=null,v=null,x=null,g=function(e){return null!==f?f:(f=new Promise((function(t,r){if("undefined"!==typeof window&&"undefined"!==typeof document)if(window.Stripe&&e&&console.warn(m),window.Stripe)t(window.Stripe);else try{var s=function(){for(var e,t=document.querySelectorAll('script[src^="'.concat(d,'"]')),r=0;r<t.length;r++){var s=t[r];if(e=s.src,u.test(e)||p.test(e))return s}return null}();if(s&&e)console.warn(m);else if(s){if(s&&null!==x&&null!==v){var n;s.removeEventListener("load",x),s.removeEventListener("error",v),null===(n=s.parentNode)||void 0===n||n.removeChild(s),s=h(e)}}else s=h(e);x=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}}(t,r),v=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}}(r),s.addEventListener("load",x),s.addEventListener("error",v)}catch(a){return void r(a)}else t(null)}))).catch((function(e){return f=null,Promise.reject(e)}))},w=!1,j=function(){return s||(s=g(null).catch((function(e){return s=null,Promise.reject(e)})))};Promise.resolve().then((function(){return j()})).catch((function(e){w||console.warn(e)}));var b=r(579);const y=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];w=!0;var s=Date.now();return j().then((function(e){return function(e,t,r){if(null===e)return null;var s=t[0].match(/^pk_test/),n=function(e){return 3===e?"v3":e}(e.version),a=c;s&&n!==a&&console.warn("Stripe.js@".concat(n," was loaded on the page, but @stripe/stripe-js@").concat("7.3.0"," expected Stripe.js@").concat(a,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var i=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"7.3.0",startTime:t})}(i,r),i}(e,t,s)}))}("pk_test_51RNEmFPxiXl6gYuTxfzucygRKGJRsU3IIfkVCA580gF63522WkXs4la3gE6r6YAewOk1ngzRwFPgYy2SdcWkvdPO00brPbqZwl"),S=()=>{var e;const{cartItems:t,cartTotal:r,clearCart:s}=(0,a._)(),c=(0,i.Zp)(),d=(0,i.zy)(),[l,u]=(0,n.useState)(null),[p,m]=(0,n.useState)(!1),h=(null===(e=d.state)||void 0===e?void 0:e.totalAfterDiscount)||r;(0,n.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token"),t=JSON.parse(localStorage.getItem("userAddress"));if(t&&t.addressLine1)return void u(t);if(e){console.log("Fetching address from:","http://13.233.144.153/api/customers/users/address");const t=await o.A.get("http://13.233.144.153/api/customers/users/address",{headers:{Authorization:`Bearer ${e}`}});t.data.address&&(u(t.data.address),localStorage.setItem("userAddress",JSON.stringify(t.data.address)))}}catch(e){console.error("Error loading address:",e);try{const e=JSON.parse(localStorage.getItem("userAddress"));e&&e.addressLine1?u(e):u(null)}catch(t){console.error("Error parsing userAddress:",t),u(null)}}})()}),[]);return(0,b.jsxs)("div",{className:"payment-container d-flex flex-column align-items-center",style:{minHeight:"100vh",padding:"20px"},children:[l&&(0,b.jsxs)("div",{className:"mb-3 text-start w-100",style:{maxWidth:"350px"},children:[(0,b.jsx)("h6",{children:"Delivery to:"}),(0,b.jsxs)("p",{children:[l.label,": ",l.addressLine1,", ",l.houseNo,", ",l.building,l.landmark?`, ${l.landmark}`:"",l.zipCode?`, ${l.zipCode}`:""]})]}),(0,b.jsxs)("div",{className:"order-summary mb-4 w-100",style:{maxWidth:"350px"},children:[(0,b.jsx)("h6",{children:"Order Summary"}),(0,b.jsxs)("p",{children:["Subtotal: \u20b9",r.toFixed(2)]}),(0,b.jsxs)("p",{children:["Discount: \u20b9",(r-h).toFixed(2)]}),(0,b.jsx)("p",{children:(0,b.jsxs)("strong",{children:["Total: \u20b9",h.toFixed(2)]})})]}),(0,b.jsx)("div",{className:"creditcard mb-4",children:(0,b.jsxs)("div",{className:"thecard-modern shadow-lg text-white p-4",style:{background:"linear-gradient(135deg, #1e90ff, #00bfff)",borderRadius:"15px",width:"350px",height:"200px"},children:[(0,b.jsxs)("div",{className:"card-top d-flex justify-content-between align-items-center mb-3",children:[(0,b.jsx)("div",{className:"chip",style:{width:"40px",height:"30px",background:"#d4af37",borderRadius:"5px"}}),(0,b.jsx)("div",{className:"brand",style:{fontSize:"24px",fontWeight:"bold"},children:"VISA"})]}),(0,b.jsx)("div",{className:"card-number mb-3",style:{fontSize:"20px",letterSpacing:"2px"},children:"**** **** **** 0000"}),(0,b.jsxs)("div",{className:"card-bottom d-flex justify-content-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"label",style:{fontSize:"12px"},children:"Card Holder"}),(0,b.jsx)("div",{className:"value",style:{fontSize:"16px"},children:"Your Name"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"label",style:{fontSize:"12px"},children:"Expires"}),(0,b.jsx)("div",{className:"value",style:{fontSize:"16px"},children:"01 / 2026"})]})]})]})}),(0,b.jsx)("div",{className:"form p-3 mt-3 shadow bg-white rounded",style:{width:"350px"},children:(0,b.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m(!0);const r=localStorage.getItem("email");if(!r||"undefined"===r)return alert("Please log in first."),c("/Login"),void m(!1);if(!l||!l.addressLine1)return alert("Please add a shipping address."),c("/cart"),void m(!1);const s={email:r,items:t.map((e=>({ProductID:e.ProductID,ProductName:e.ProductName,ProductPrice:parseFloat(e.ProductPrice),ProductQuantity:e.quantity,ProductImage:e.ProductImage}))),total:h,address:l};console.log("Sending checkout data:",s);try{console.log("Creating checkout session at:","http://13.233.144.153/api/customers/create-checkout-session");const e=await o.A.post("http://13.233.144.153/api/customers/create-checkout-session",s);console.log("Checkout session response:",e.data);const t=e.data.id,r=await y,{error:n}=await r.redirectToCheckout({sessionId:t});n&&(console.error("Error redirecting to Checkout:",n),alert(`Failed to initiate checkout: ${n.message}`),m(!1))}catch(i){var n,a;console.error("Checkout error:",i),alert(`Checkout failed: ${(null===(n=i.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message)||i.message}`),m(!1)}},children:[(0,b.jsx)("p",{className:"text-center mb-3",children:"Click below to pay securely with Stripe."}),(0,b.jsx)("button",{type:"submit",className:"btn btn-success w-100",disabled:p,children:p?"Processing...":`Pay \u20b9${h.toFixed(2)} with Stripe`})]})})]})}}}]);
//# sourceMappingURL=193.74795ac8.chunk.js.map