{"version":3,"file":"static/js/860.e5c1f5f4.chunk.js","mappings":"kLAKA,MA6EA,EA7EgBA,KACd,MAAMC,GAAWC,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,OACX,UAAEC,IAAcC,EAAAA,EAAAA,MACfC,EAAOC,IAAYC,EAAAA,EAAAA,UAAS,OAC5BC,EAAWC,IAAgBF,EAAAA,EAAAA,WAAS,GA4C3C,OA1CAG,EAAAA,EAAAA,YAAU,KACUC,WAChB,MAAMC,EAAY,IAAIC,gBAAgBZ,EAASa,QAAQC,IAAI,cAC3D,IAAKH,EAGH,OAFAN,EAAS,2CACTG,GAAa,GAIf,IACE,MAAMO,EAAQC,aAAaC,QAAQ,SAC7BC,EAAUC,KAAKC,MAAMJ,aAAaC,QAAQ,gBAAkB,MAElE,IAAKF,IAAUG,IAAYA,EAAQG,aAGjC,OAFAhB,EAAS,gFACTG,GAAa,GAIfc,QAAQC,IAAI,qBAAsB,CAAEZ,YAAWI,QAAOG,YACtDI,QAAQC,IAAI,mBAAoB,uDAEhC,MAAMC,QAAiBC,EAAAA,EAAMC,KAAK,sDAAmE,CACnGX,QACAG,UACAP,cAGFW,QAAQC,IAAI,eAAgBC,EAASG,MACrCzB,IACAM,GAAa,GACbV,EAAS,UACX,CAAE,MAAOM,GAAQ,IAADwB,EAAAC,EACdP,QAAQlB,MAAM,sBAAuBA,GACrCC,EAAS,0BAAuC,QAAduB,EAAAxB,EAAMoB,gBAAQ,IAAAI,GAAM,QAANC,EAAdD,EAAgBD,YAAI,IAAAE,OAAN,EAAdA,EAAsBC,UAAW1B,EAAM0B,WACzEtB,GAAa,EACf,GAGFuB,EAAW,GACV,CAAC/B,EAAUF,EAAUI,KAGtB8B,EAAAA,EAAAA,KAAA,OAAKC,UAAU,6BAA4BC,SACxC3B,GACC4B,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAF,SAAA,EACEF,EAAAA,EAAAA,KAAA,MAAAE,SAAI,8BACJF,EAAAA,EAAAA,KAAA,KAAAE,SAAG,iDAEH9B,GACF+B,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAF,SAAA,EACEF,EAAAA,EAAAA,KAAA,MAAAE,SAAI,6BACJF,EAAAA,EAAAA,KAAA,KAAAE,SAAI9B,KACJ4B,EAAAA,EAAAA,KAAA,UAAQC,UAAU,kBAAkBI,QAASA,IAAMvC,EAAS,SAASoC,SAAC,uBAKxEC,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAF,SAAA,EACEF,EAAAA,EAAAA,KAAA,MAAAE,SAAI,gCACJF,EAAAA,EAAAA,KAAA,KAAAE,SAAG,0EACHF,EAAAA,EAAAA,KAAA,UAAQC,UAAU,kBAAkBI,QAASA,IAAMvC,EAAS,WAAWoC,SAAC,2BAKxE,C","sources":["pages/success.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useCart } from '../contexts/cartContext';\r\n\r\nconst Success = () => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { clearCart } = useCart();\r\n  const [error, setError] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const saveOrder = async () => {\r\n      const sessionId = new URLSearchParams(location.search).get('session_id');\r\n      if (!sessionId) {\r\n        setError('Invalid session. Please try again.');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const email = localStorage.getItem('email');\r\n        const address = JSON.parse(localStorage.getItem('userAddress') || '{}');\r\n\r\n        if (!email || !address || !address.addressLine1) {\r\n          setError('Missing user information. Please log in and ensure an address is saved.');\r\n          setIsLoading(false);\r\n          return;\r\n        }\r\n\r\n        console.log('Saving order with:', { sessionId, email, address });\r\n        console.log('Saving order to:', `${process.env.REACT_APP_API_BASE_URL}/api/customers/orders/save`); // Debug log\r\n\r\n        const response = await axios.post(`${process.env.REACT_APP_API_BASE_URL}/api/customers/orders/save`, {\r\n          email,\r\n          address,\r\n          sessionId,\r\n        });\r\n\r\n        console.log('Order saved:', response.data);\r\n        clearCart();\r\n        setIsLoading(false);\r\n        navigate('/orders'); // Redirect to order history\r\n      } catch (error) {\r\n        console.error('Error saving order:', error);\r\n        setError(`Failed to save order: ${error.response?.data?.message || error.message}`);\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    saveOrder();\r\n  }, [location, navigate, clearCart]);\r\n\r\n  return (\r\n    <div className=\"container mt-5 text-center\">\r\n      {isLoading ? (\r\n        <>\r\n          <h2>Processing Your Order...</h2>\r\n          <p>Please wait while we finalize your order.</p>\r\n        </>\r\n      ) : error ? (\r\n        <>\r\n          <h2>Order Processing Failed</h2>\r\n          <p>{error}</p>\r\n          <button className=\"btn btn-primary\" onClick={() => navigate('/cart')}>\r\n            Return to Cart\r\n          </button>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <h2>Order Placed Successfully!</h2>\r\n          <p>Your order has been processed. Check your order history for details.</p>\r\n          <button className=\"btn btn-primary\" onClick={() => navigate('/orders')}>\r\n            View Order History\r\n          </button>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Success;"],"names":["Success","navigate","useNavigate","location","useLocation","clearCart","useCart","error","setError","useState","isLoading","setIsLoading","useEffect","async","sessionId","URLSearchParams","search","get","email","localStorage","getItem","address","JSON","parse","addressLine1","console","log","response","axios","post","data","_error$response","_error$response$data","message","saveOrder","_jsx","className","children","_jsxs","_Fragment","onClick"],"sourceRoot":""}