"use strict";(self.webpackChunkzepto2=self.webpackChunkzepto2||[]).push([[896],{8896:(e,r,s)=>{s.r(r),s.d(r,{default:()=>a});var d=s(5043),n=s(6213),t=s(579);const a=function(){const[e,r]=(0,d.useState)([]),[s,a]=(0,d.useState)([]),[l,o]=(0,d.useState)(!1),[i,c]=(0,d.useState)({name:"",vendorId:"",address:"",licenseNumber:""}),[u,h]=(0,d.useState)(null),[m,v]=(0,d.useState)(null),[x,j]=(0,d.useState)("");(0,d.useEffect)((()=>{b(),p()}),[]);const b=async()=>{try{const e=(await n.A.get("http://13.233.144.153/api/auth/users")).data.filter((e=>"vendor"===e.role)).map((e=>({...e,source:"user"}))),s=(await n.A.get("http://13.233.144.153/api/vendors")).data.map((e=>({...e,source:"vendor"}))),d=[...e,...s].sort(((e,r)=>e.name.localeCompare(r.name)));r(d),j("")}catch(x){var e,s;console.error("Error fetching vendors:",x),j((null===(e=x.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||"Failed to fetch vendors")}},p=async()=>{try{const e=await n.A.get("http://13.233.144.153/api/customers/orders/all");a(e.data),j("")}catch(x){var e,r;console.error("Error fetching orders:",x),j((null===(e=x.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||"Failed to fetch orders")}},N=e=>{c({...i,[e.target.name]:e.target.value})};return(0,t.jsxs)("div",{className:"container mt-4",children:[(0,t.jsx)("h2",{children:"Admin Dashboard"}),x&&(0,t.jsx)("div",{className:"alert alert-danger",children:x}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("input",{name:"name",placeholder:"Vendor Name",value:i.name,onChange:N,className:"form-control mb-2",disabled:"user"===m}),(0,t.jsx)("input",{name:"vendorId",placeholder:"Vendor ID",value:i.vendorId,onChange:N,className:"form-control mb-2",disabled:"user"===m}),(0,t.jsx)("input",{name:"address",placeholder:"Address",value:i.address,onChange:N,className:"form-control mb-2",disabled:"user"===m}),(0,t.jsx)("input",{name:"licenseNumber",placeholder:"License Number",value:i.licenseNumber,onChange:N,className:"form-control mb-2"}),(0,t.jsx)("button",{onClick:async()=>{if("user"===m){if(!i.licenseNumber)return void j("License number is required");try{console.log("Updating user with data:",i,"and editId:",u);const e=await n.A.put(`http://13.233.144.153/api/auth/users/${u}`,{licenseNumber:i.licenseNumber});console.log("User updated:",e.data),alert("Vendor license number updated successfully!"),c({name:"",vendorId:"",address:"",licenseNumber:""}),h(null),v(null),j(""),b()}catch(x){var e,r;console.error("Error updating user:",x),j((null===(e=x.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||"Failed to update vendor")}}else{if(!i.name||!i.vendorId||!i.address||!i.licenseNumber)return void j("Please fill all fields");try{if(console.log("Submitting vendor with data:",i,"and editId:",u),u){const e=await n.A.put(`http://13.233.144.153/api/vendors/${u}`,i);console.log("Vendor updated:",e.data),alert("Vendor updated successfully!")}else{const e=await n.A.post("http://13.233.144.153/api/vendors",i);console.log("Vendor created:",e.data),alert("Vendor added successfully!")}c({name:"",vendorId:"",address:"",licenseNumber:""}),h(null),v(null),j(""),b()}catch(x){var s,d;console.error("Error submitting vendor:",x),j((null===(s=x.response)||void 0===s||null===(d=s.data)||void 0===d?void 0:d.message)||"Failed to save vendor")}}},className:"btn btn-primary",children:"user"===m?"Update License Number":u?"Update Vendor":"Add Vendor"})]}),(0,t.jsx)("h3",{children:"Vendors"}),(0,t.jsx)("div",{className:"table-responsive mb-5",children:(0,t.jsxs)("table",{className:"table table-bordered table-striped",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Sl No"}),(0,t.jsx)("th",{children:"Name"}),(0,t.jsx)("th",{children:"Role/Source"}),(0,t.jsx)("th",{children:"Vendor ID"}),(0,t.jsx)("th",{children:"Email"}),(0,t.jsx)("th",{children:"Address"}),(0,t.jsx)("th",{children:"License Number"}),(0,t.jsx)("th",{children:"Actions"})]})}),(0,t.jsx)("tbody",{children:e.map(((e,r)=>{var s;return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:r+1}),(0,t.jsx)("td",{children:e.name}),(0,t.jsx)("td",{children:"user"===e.source?e.role:"Vendor"}),(0,t.jsx)("td",{children:e.vendorId||"N/A"}),(0,t.jsx)("td",{children:e.email||"N/A"}),(0,t.jsx)("td",{children:"user"===e.source?(null===(s=e.address)||void 0===s?void 0:s.addressLine1)||"N/A":e.address||"N/A"}),(0,t.jsx)("td",{children:e.licenseNumber||"N/A"}),(0,t.jsxs)("td",{children:[(0,t.jsx)("button",{onClick:()=>(e=>{var r;c({name:e.name||"",vendorId:e.vendorId||"",address:(null===(r=e.address)||void 0===r?void 0:r.addressLine1)||e.address||"",licenseNumber:e.licenseNumber||""}),h(e._id),v(e.source),j("")})(e),className:"btn btn-sm btn-warning me-2",children:"Update"}),"vendor"===e.source&&(0,t.jsx)("button",{onClick:()=>(async(e,r)=>{if(window.confirm("Are you sure you want to delete this vendor?"))try{if("user"===r)return void j("Cannot delete registered vendors");await n.A.delete(`http://13.233.144.153/api/vendors/${e}`),alert("Vendor deleted successfully!"),j(""),b()}catch(x){var s,d;console.error("Error deleting vendor:",x),j((null===(s=x.response)||void 0===s||null===(d=s.data)||void 0===d?void 0:d.message)||"Failed to delete vendor")}})(e._id,e.source),className:"btn btn-sm btn-danger",children:"Delete"})]})]},`${e._id}-${e.source}`)}))})]})}),(0,t.jsx)("button",{onClick:()=>{o(!l)},className:"btn btn-primary mb-3",children:l?"Hide Order History":"Show All Order History"}),l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{children:"All Customer Orders"}),(0,t.jsx)("div",{className:"table-responsive",children:(0,t.jsxs)("table",{className:"table table-bordered table-striped",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Sl No"}),(0,t.jsx)("th",{children:"Order ID"}),(0,t.jsx)("th",{children:"Customer Email"}),(0,t.jsx)("th",{children:"Customer Name"}),(0,t.jsx)("th",{children:"Total Amount"}),(0,t.jsx)("th",{children:"Items"}),(0,t.jsx)("th",{children:"Address"}),(0,t.jsx)("th",{children:"Payment Status"}),(0,t.jsx)("th",{children:"Order Date"})]})}),(0,t.jsx)("tbody",{children:s.map(((e,r)=>{var s,d,n;return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:r+1}),(0,t.jsx)("td",{children:e._id}),(0,t.jsx)("td",{children:(null===(s=e.user)||void 0===s?void 0:s.email)||"N/A"}),(0,t.jsx)("td",{children:(null===(d=e.user)||void 0===d?void 0:d.name)||"N/A"}),(0,t.jsxs)("td",{children:["\u20b9",e.total.toFixed(2)]}),(0,t.jsx)("td",{children:e.items.map(((e,r)=>(0,t.jsxs)("div",{children:[e.ProductName," (Qty: ",e.ProductQuantity,", Price: \u20b9",e.ProductPrice,")"]},r)))}),(0,t.jsx)("td",{children:null!==(n=e.address)&&void 0!==n&&n.addressLine1?`${e.address.houseNo}, ${e.address.addressLine1}, ${e.address.building}`:"N/A"}),(0,t.jsx)("td",{children:e.paymentStatus}),(0,t.jsx)("td",{children:new Date(e.createdAt).toLocaleString()})]},e._id)}))})]})})]})]})}}}]);
//# sourceMappingURL=896.08a9812e.chunk.js.map