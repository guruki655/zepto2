{"ast":null,"code":"var _jsxFileName = \"D:\\\\ITD\\\\zepto2\\\\zepto2\\\\src\\\\pages\\\\success.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { useCart } from '../contexts/cartContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Success() {\n  _s();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const {\n    clearCart\n  } = useCart();\n  useEffect(() => {\n    const saveOrder = async () => {\n      const sessionId = new URLSearchParams(location.search).get('session_id');\n      if (!sessionId) {\n        alert('No session ID found.');\n        navigate('/');\n        return;\n      }\n      try {\n        const token = localStorage.getItem('token');\n        const response = await axios.post('http://localhost:5000/api/customers/orders/save', {\n          sessionId\n        }, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        console.log('Order save response:', response.data);\n        alert('Payment successful and order saved!');\n        clearCart();\n        navigate('/orders');\n      } catch (error) {\n        var _error$response, _error$response$data;\n        console.error('Error saving order:', error);\n        alert('Failed to save order: ' + ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message);\n        navigate('/');\n      }\n    };\n    saveOrder();\n  }, [location, navigate, clearCart]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Processing your order...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 10\n  }, this);\n}\n_s(Success, \"Xb5iKbSTk9PD3+JxxosU9F5zLxQ=\", false, function () {\n  return [useLocation, useNavigate, useCart];\n});\n_c = Success;\nexport default Success;\nvar _c;\n$RefreshReg$(_c, \"Success\");","map":{"version":3,"names":["React","useEffect","useLocation","useNavigate","axios","useCart","jsxDEV","_jsxDEV","Success","_s","location","navigate","clearCart","saveOrder","sessionId","URLSearchParams","search","get","alert","token","localStorage","getItem","response","post","headers","Authorization","console","log","data","error","_error$response","_error$response$data","message","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/ITD/zepto2/zepto2/src/pages/success.js"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useCart } from '../contexts/cartContext';\r\n\r\nfunction Success() {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const { clearCart } = useCart();\r\n\r\n  useEffect(() => {\r\n    const saveOrder = async () => {\r\n      const sessionId = new URLSearchParams(location.search).get('session_id');\r\n      if (!sessionId) {\r\n        alert('No session ID found.');\r\n        navigate('/');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const response = await axios.post(\r\n          'http://localhost:5000/api/customers/orders/save',\r\n          { sessionId },\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n        console.log('Order save response:', response.data);\r\n        alert('Payment successful and order saved!');\r\n        clearCart();\r\n        navigate('/orders');\r\n      } catch (error) {\r\n        console.error('Error saving order:', error);\r\n        alert('Failed to save order: ' + error.response?.data?.message || error.message);\r\n        navigate('/');\r\n      }\r\n    };\r\n\r\n    saveOrder();\r\n  }, [location, navigate, clearCart]);\r\n\r\n  return <div>Processing your order...</div>;\r\n}\r\n\r\nexport default Success;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,WAAW,EAAEC,WAAW,QAAQ,kBAAkB;AAC3D,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,OAAO,QAAQ,yBAAyB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAElD,SAASC,OAAOA,CAAA,EAAG;EAAAC,EAAA;EACjB,MAAMC,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAC9B,MAAMS,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAES;EAAU,CAAC,GAAGP,OAAO,CAAC,CAAC;EAE/BJ,SAAS,CAAC,MAAM;IACd,MAAMY,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,MAAMC,SAAS,GAAG,IAAIC,eAAe,CAACL,QAAQ,CAACM,MAAM,CAAC,CAACC,GAAG,CAAC,YAAY,CAAC;MACxE,IAAI,CAACH,SAAS,EAAE;QACdI,KAAK,CAAC,sBAAsB,CAAC;QAC7BP,QAAQ,CAAC,GAAG,CAAC;QACb;MACF;MAEA,IAAI;QACF,MAAMQ,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QAC3C,MAAMC,QAAQ,GAAG,MAAMlB,KAAK,CAACmB,IAAI,CAC/B,iDAAiD,EACjD;UAAET;QAAU,CAAC,EACb;UAAEU,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUN,KAAK;UAAG;QAAE,CAClD,CAAC;QACDO,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEL,QAAQ,CAACM,IAAI,CAAC;QAClDV,KAAK,CAAC,qCAAqC,CAAC;QAC5CN,SAAS,CAAC,CAAC;QACXD,QAAQ,CAAC,SAAS,CAAC;MACrB,CAAC,CAAC,OAAOkB,KAAK,EAAE;QAAA,IAAAC,eAAA,EAAAC,oBAAA;QACdL,OAAO,CAACG,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;QAC3CX,KAAK,CAAC,wBAAwB,KAAAY,eAAA,GAAGD,KAAK,CAACP,QAAQ,cAAAQ,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBF,IAAI,cAAAG,oBAAA,uBAApBA,oBAAA,CAAsBC,OAAO,KAAIH,KAAK,CAACG,OAAO,CAAC;QAChFrB,QAAQ,CAAC,GAAG,CAAC;MACf;IACF,CAAC;IAEDE,SAAS,CAAC,CAAC;EACb,CAAC,EAAE,CAACH,QAAQ,EAAEC,QAAQ,EAAEC,SAAS,CAAC,CAAC;EAEnC,oBAAOL,OAAA;IAAA0B,QAAA,EAAK;EAAwB;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAK,CAAC;AAC5C;AAAC5B,EAAA,CApCQD,OAAO;EAAA,QACGN,WAAW,EACXC,WAAW,EACNE,OAAO;AAAA;AAAAiC,EAAA,GAHtB9B,OAAO;AAsChB,eAAeA,OAAO;AAAC,IAAA8B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}