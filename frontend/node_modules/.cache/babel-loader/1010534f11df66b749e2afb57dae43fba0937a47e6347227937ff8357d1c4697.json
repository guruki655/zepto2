{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OrderHistory=()=>{const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const navigate=useNavigate();useEffect(()=>{const fetchOrderHistory=async()=>{try{const email=localStorage.getItem('email');if(!email){setError('Please log in to view your order history.');setLoading(false);return;}console.log('Fetching order history from:',`${process.env.REACT_APP_API_BASE_URL}/api/customers/orders/history/${email}`);// Debug log\nconst response=await axios.get(`${process.env.REACT_APP_API_BASE_URL}/api/customers/orders/history/${email}`);console.log('Fetched orders:',response.data);// Log to verify ProductImage\nsetOrders(response.data);setLoading(false);}catch(err){var _err$response,_err$response$data;console.error('Error fetching order history:',err);setError('Failed to fetch order history: '+(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||err.message));setLoading(false);}};fetchOrderHistory();},[]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center mt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-primary\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger mt-5\",children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-4\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"mb-4\",children:[\"Your Order History\",' ',orders.length>0&&/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"(\",orders.length,\" orders)\"]})]}),orders.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mt-5\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/images/empty-cart.png\",alt:\"Empty Cart\",style:{width:'100px',height:'100px'}}),/*#__PURE__*/_jsx(\"p\",{className:\"lead mt-3\",children:\"You haven't placed any orders yet.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>navigate('/Home'),children:\"Start Shopping\"})]}):orders.map(order=>/*#__PURE__*/_jsxs(\"div\",{className:\"card mb-4 shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header bg-light\",children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[\"Order ID: \",/*#__PURE__*/_jsx(\"code\",{children:order._id})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Total:\"}),\" \\u20B9\",order.total.toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),' ',new Date(order.createdAt).toLocaleString('en-US',{year:'numeric',month:'long',day:'numeric',hour:'numeric',minute:'numeric',hour12:true})]}),order.address&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Delivery Address:\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0\",children:[order.address.label,\": \",order.address.addressLine1,\", \",order.address.houseNo,\", \",order.address.building,order.address.landmark?`, ${order.address.landmark}`:'']})]}),/*#__PURE__*/_jsx(\"h6\",{className:\"mt-3\",children:\"Items Ordered:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-group list-group-flush\",children:order.items.map((item,index)=>{var _item$ProductPrice;return/*#__PURE__*/_jsxs(\"li\",{className:\"list-group-item d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.ProductImage?`data:image/png;base64,${item.ProductImage}`:'/images/placeholder.png',alt:item.ProductName,className:\"rounded\",style:{width:'60px',height:'60px',objectFit:'cover',marginRight:'15px'}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1\",children:[/*#__PURE__*/_jsx(\"strong\",{children:item.ProductName||'Unnamed Product'}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-muted small\",children:[\"\\u20B9\",((_item$ProductPrice=item.ProductPrice)===null||_item$ProductPrice===void 0?void 0:_item$ProductPrice.toFixed(2))||'0.00',\" x \",item.ProductQuantity||0]})]})]},index);})})]})]},order._id))]});};export default OrderHistory;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","OrderHistory","orders","setOrders","loading","setLoading","error","setError","navigate","fetchOrderHistory","email","localStorage","getItem","console","log","process","env","REACT_APP_API_BASE_URL","response","get","data","err","_err$response","_err$response$data","message","className","children","role","length","src","alt","style","width","height","onClick","map","order","_id","total","toFixed","Date","createdAt","toLocaleString","year","month","day","hour","minute","hour12","address","label","addressLine1","houseNo","building","landmark","items","item","index","_item$ProductPrice","ProductImage","ProductName","objectFit","marginRight","ProductPrice","ProductQuantity"],"sources":["D:/ITD/zepto2/zepto2/src/pages/prevOrder.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst OrderHistory = () => {\r\n  const [orders, setOrders] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchOrderHistory = async () => {\r\n      try {\r\n        const email = localStorage.getItem('email');\r\n        if (!email) {\r\n          setError('Please log in to view your order history.');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        console.log('Fetching order history from:', `${process.env.REACT_APP_API_BASE_URL}/api/customers/orders/history/${email}`); // Debug log\r\n        const response = await axios.get(`${process.env.REACT_APP_API_BASE_URL}/api/customers/orders/history/${email}`);\r\n        console.log('Fetched orders:', response.data); // Log to verify ProductImage\r\n        setOrders(response.data);\r\n        setLoading(false);\r\n      } catch (err) {\r\n        console.error('Error fetching order history:', err);\r\n        setError('Failed to fetch order history: ' + (err.response?.data?.message || err.message));\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchOrderHistory();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"d-flex justify-content-center mt-5\">\r\n        <div className=\"spinner-border text-primary\" role=\"status\">\r\n          <span className=\"visually-hidden\">Loading...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"alert alert-danger mt-5\">{error}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mt-4\">\r\n      <h2 className=\"mb-4\">\r\n        Your Order History{' '}\r\n        {orders.length > 0 && <small className=\"text-muted\">({orders.length} orders)</small>}\r\n      </h2>\r\n      {orders.length === 0 ? (\r\n        <div className=\"text-center mt-5\">\r\n          <img src=\"/images/empty-cart.png\" alt=\"Empty Cart\" style={{ width: '100px', height: '100px' }} />\r\n          <p className=\"lead mt-3\">You haven't placed any orders yet.</p>\r\n          <button className=\"btn btn-primary\" onClick={() => navigate('/Home')}>\r\n            Start Shopping\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        orders.map((order) => (\r\n          <div key={order._id} className=\"card mb-4 shadow-sm\">\r\n            <div className=\"card-header bg-light\">\r\n              <h5 className=\"mb-0\">Order ID: <code>{order._id}</code></h5>\r\n            </div>\r\n            <div className=\"card-body\">\r\n              <div className=\"mb-2\">\r\n                <strong>Total:</strong> â‚¹{order.total.toFixed(2)}\r\n              </div>\r\n              <div className=\"mb-2\">\r\n                <strong>Date:</strong>{' '}\r\n                {new Date(order.createdAt).toLocaleString('en-US', {\r\n                  year: 'numeric',\r\n                  month: 'long',\r\n                  day: 'numeric',\r\n                  hour: 'numeric',\r\n                  minute: 'numeric',\r\n                  hour12: true,\r\n                })}\r\n              </div>\r\n              {order.address && (\r\n                <div className=\"mb-3\">\r\n                  <strong>Delivery Address:</strong>\r\n                  <p className=\"mb-0\">\r\n                    {order.address.label}: {order.address.addressLine1}, {order.address.houseNo}, {order.address.building}\r\n                    {order.address.landmark ? `, ${order.address.landmark}` : ''}\r\n                  </p>\r\n                </div>\r\n              )}\r\n              <h6 className=\"mt-3\">Items Ordered:</h6>\r\n              <ul className=\"list-group list-group-flush\">\r\n                {order.items.map((item, index) => (\r\n                  <li key={index} className=\"list-group-item d-flex align-items-center\">\r\n                    <img\r\n                      src={item.ProductImage ? `data:image/png;base64,${item.ProductImage}` : '/images/placeholder.png'}\r\n                      alt={item.ProductName}\r\n                      className=\"rounded\"\r\n                      style={{ width: '60px', height: '60px', objectFit: 'cover', marginRight: '15px' }}\r\n                    />\r\n                    <div className=\"flex-grow-1\">\r\n                      <strong>{item.ProductName || 'Unnamed Product'}</strong>\r\n                      <div className=\"text-muted small\">\r\n                        â‚¹{item.ProductPrice?.toFixed(2) || '0.00'} x {item.ProductQuantity || 0}\r\n                      </div>\r\n                    </div>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        ))\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderHistory;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}